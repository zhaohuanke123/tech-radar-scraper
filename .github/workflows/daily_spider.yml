name: ğŸ›°ï¸ Daily Tech Radar

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  è§¦å‘æ¡ä»¶
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
on:
  schedule:
    # Cron æ ¼å¼ï¼ˆUTC æ—¶é—´ï¼‰ï¼šUTC 00:00 = åŒ—äº¬æ—¶é—´ 08:00
    - cron: "0 0 * * *"

  # ä¹Ÿå…è®¸åœ¨ GitHub Actions é¡µé¢æ‰‹åŠ¨è§¦å‘ï¼Œæ–¹ä¾¿è°ƒè¯•
  workflow_dispatch:

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  æƒé™ï¼šå…è®¸å·¥ä½œæµå‘ä»“åº“å†™å…¥ï¼ˆgit pushï¼‰
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
permissions:
  contents: write

jobs:
  scrape-and-commit:
    name: æŠ“å–æ•°æ®å¹¶æäº¤æŠ¥å‘Š
    runs-on: ubuntu-latest

    steps:
      # â”€â”€ æ­¥éª¤ 1: æ‹‰å–ä»“åº“ä»£ç  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ğŸ“¥ Checkout ä»“åº“
        uses: actions/checkout@v4
        with:
          # ä½¿ç”¨å†…ç½®çš„ GITHUB_TOKEN è¿›è¡Œèº«ä»½éªŒè¯ä¸æ¨é€
          token: ${{ secrets.GITHUB_TOKEN }}

      # â”€â”€ æ­¥éª¤ 2: å®‰è£… uv åŒ…ç®¡ç†å™¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: âš¡ å®‰è£… uv
        uses: astral-sh/setup-uv@v4
        with:
          version: "latest"
          enable-cache: true  # ç¼“å­˜ä¾èµ–åŠ é€Ÿåç»­æ‰§è¡Œ

      # â”€â”€ æ­¥éª¤ 3: è®¾ç½® Python ç‰ˆæœ¬ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ğŸ è®¾ç½® Python 3.11
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      # â”€â”€ æ­¥éª¤ 4: å®‰è£…é¡¹ç›®ä¾èµ– â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ğŸ“¦ å®‰è£…ä¾èµ–ï¼ˆvia uvï¼‰
        run: |
          uv sync
          echo "âœ… ä¾èµ–å®‰è£…å®Œæˆ"

      # â”€â”€ æ­¥éª¤ 5: è¿è¡Œä¸»çˆ¬è™«è„šæœ¬ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ğŸš€ è¿è¡Œ Tech Radar Scraper
        env:
          # ä» GitHub Secrets è¯»å– Tokenï¼ˆæé«˜ API é€Ÿç‡é™åˆ¶ï¼‰
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          uv run python src/main.py
          echo "âœ… çˆ¬è™«è¿è¡Œå®Œæˆ"

      # â”€â”€ æ­¥éª¤ 6: æ£€æµ‹æ–°æŠ¥å‘Šå¹¶æäº¤æ¨é€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ğŸ“¤ æäº¤å¹¶æ¨é€æ–°æŠ¥å‘Š
        run: |
          # é…ç½® git èº«ä»½ï¼ˆä½¿ç”¨ GitHub Actions çš„æœºå™¨äººè´¦å·ï¼‰
          git config user.name  "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"

          # å°†æ–°ç”Ÿæˆçš„æŠ¥å‘Šå’Œæ—¥å¿—åŠ å…¥æš‚å­˜åŒº
          git add reports/ logs/

          # æ£€æŸ¥æ˜¯å¦æœ‰å®é™…å˜æ›´ï¼ˆé¿å…ç©ºæäº¤å¯¼è‡´æŠ¥é”™ï¼‰
          if git diff --staged --quiet; then
            echo "â„¹ï¸  æ²¡æœ‰æ–°æ–‡ä»¶å˜æ›´ï¼Œè·³è¿‡æäº¤"
          else
            # æäº¤ä¿¡æ¯åŒ…å«æ—¶é—´æˆ³ï¼Œæ–¹ä¾¿è¿½æº¯
            git commit -m "ğŸ›°ï¸ Auto-update tech radar [$(date +'%Y-%m-%d %H:%M UTC')]"
            git push
            echo "âœ… æ–°æŠ¥å‘Šå·²æ¨é€åˆ°ä»“åº“"
          fi
